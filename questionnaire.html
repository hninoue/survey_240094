<!DOCTYPE html>
<html>
  <head>
    <title>調査_井上</title>
    <script src="https://unpkg.com/jspsych@7.3.4"></script>
    <script src="https://unpkg.com/@jspsych/plugin-preload@1.1.3"></script>
    <script src="https://unpkg.com/@jspsych/plugin-html-keyboard-response@1.1.3"></script>
    <script src="https://unpkg.com/@jspsych/plugin-audio-keyboard-response@1.1.3"></script>
    <script src="https://unpkg.com/@jspsych/plugin-html-button-response@1.2.0"></script>
    <script src="https://unpkg.com/@jspsych-contrib/plugin-pipe"></script>
    <link href="https://unpkg.com/jspsych@7.3.4/css/jspsych.css" rel="stylesheet" type="text/css" />
  </head>
  <body></body>
  <script>
    const jsPsych = initJsPsych();

    // フルスクリーンのリクエスト関数
    function enterFullScreen() {
      const docElement = document.documentElement;
      if (docElement.requestFullscreen) {
        docElement.requestFullscreen();
      } else if (docElement.mozRequestFullScreen) { // Firefox
        docElement.mozRequestFullScreen();
      } else if (docElement.webkitRequestFullscreen) { // Chrome, Safari
        docElement.webkitRequestFullscreen();
      } else if (docElement.msRequestFullscreen) { // IE
        docElement.msRequestFullscreen();
      }
    }
    
    // 音声データリスト（OSFの公開URLを指定）
    var audioData = [
      { file: "https://raw.githubusercontent.com/hninoue/survey_240094/main/word000_practice.mp3", word: 'けんとうし', prosody: '音量調整' },
      { file: "https://raw.githubusercontent.com/hninoue/survey_240094/main/word001_up.mp3", word: 'すききらい', prosody: '抑揚あり' },
      { file: "https://raw.githubusercontent.com/hninoue/survey_240094/main/word002_no.mp3", word: 'きんみらい', prosody: '抑揚なし' },
      { file: "https://raw.githubusercontent.com/hninoue/survey_240094/main/word003_no.mp3", word: 'いろなおし', prosody: '抑揚なし' },
      { file: "https://raw.githubusercontent.com/hninoue/survey_240094/main/word004_up.mp3", word: 'はやとちり', prosody: '抑揚あり' },
      { file: "https://raw.githubusercontent.com/hninoue/survey_240094/main/word005_up.mp3", word: 'たほうめん', prosody: '抑揚あり' },
      { file: "https://raw.githubusercontent.com/hninoue/survey_240094/main/word006_no.mp3", word: 'すなあらし', prosody: '抑揚なし' },
      { file: "https://raw.githubusercontent.com/hninoue/survey_240094/main/word007_no.mp3", word: 'さんかいき', prosody: '抑揚なし' },
      { file: "https://raw.githubusercontent.com/hninoue/survey_240094/main/word008_up.mp3", word: 'はえたたき', prosody: '抑揚あり' },
      { file: "https://raw.githubusercontent.com/hninoue/survey_240094/main/word009_no.mp3", word: 'あおにさい', prosody: '抑揚なし' },
      { file: "https://raw.githubusercontent.com/hninoue/survey_240094/main/word010_up.mp3", word: 'ついしけん', prosody: '抑揚あり' },
      { file: "https://raw.githubusercontent.com/hninoue/survey_240094/main/word011_up.mp3", word: 'ひるやすみ', prosody: '抑揚あり' },
      { file: "https://raw.githubusercontent.com/hninoue/survey_240094/main/word012_no.mp3", word: 'やくはらい', prosody: '抑揚なし' },
      { file: "https://raw.githubusercontent.com/hninoue/survey_240094/main/word013_no.mp3", word: 'にもうさく', prosody: '抑揚なし' },
      { file: "https://raw.githubusercontent.com/hninoue/survey_240094/main/word014_up.mp3", word: 'つなわたり', prosody: '抑揚あり' },
      { file: "https://raw.githubusercontent.com/hninoue/survey_240094/main/word015_up.mp3", word: 'うりふたつ', prosody: '抑揚あり' },
      { file: "https://raw.githubusercontent.com/hninoue/survey_240094/main/word016_no.mp3", word: 'やけのはら', prosody: '抑揚なし' },
      { file: "https://raw.githubusercontent.com/hninoue/survey_240094/main/word017_no.mp3", word: 'なまかわき', prosody: '抑揚なし' },
      { file: "https://raw.githubusercontent.com/hninoue/survey_240094/main/word018_up.mp3", word: 'みかいけつ', prosody: '抑揚あり' },
      { file: "https://raw.githubusercontent.com/hninoue/survey_240094/main/word019_up.mp3", word: 'おひとよし', prosody: '抑揚あり' },
      { file: "https://raw.githubusercontent.com/hninoue/survey_240094/main/word020_no.mp3", word: 'てつあれい', prosody: '抑揚なし' },
      { file: "https://raw.githubusercontent.com/hninoue/survey_240094/main/word021_up.mp3", word: 'たまひろい', prosody: '抑揚あり' },
      { file: "https://raw.githubusercontent.com/hninoue/survey_240094/main/word022_no.mp3", word: 'うちいわい', prosody: '抑揚なし' },
      { file: "https://raw.githubusercontent.com/hninoue/survey_240094/main/word023_no.mp3", word: 'むいちもん', prosody: '抑揚なし' },
      { file: "https://raw.githubusercontent.com/hninoue/survey_240094/main/word024_up.mp3", word: 'みせいねん', prosody: '抑揚あり' },
      { file: "https://raw.githubusercontent.com/hninoue/survey_240094/main/word025_up.mp3", word: 'なまけもの', prosody: '抑揚あり' },
      { file: "https://raw.githubusercontent.com/hninoue/survey_240094/main/word026_no.mp3", word: 'むせいらん', prosody: '抑揚なし' },
      { file: "https://raw.githubusercontent.com/hninoue/survey_240094/main/word027_no.mp3", word: 'くらやしき', prosody: '抑揚なし' },
      { file: "https://raw.githubusercontent.com/hninoue/survey_240094/main/word028_up.mp3", word: 'かねもうけ', prosody: '抑揚あり' },
      { file: "https://raw.githubusercontent.com/hninoue/survey_240094/main/word029_up.mp3", word: 'はやおくり', prosody: '抑揚あり' },
      { file: "https://raw.githubusercontent.com/hninoue/survey_240094/main/word030_no.mp3", word: 'たこうしき', prosody: '抑揚なし' },
      { file: "https://raw.githubusercontent.com/hninoue/survey_240094/main/word031_no.mp3", word: 'つみつくり', prosody: '抑揚なし' },
      { file: "https://raw.githubusercontent.com/hninoue/survey_240094/main/word032_up.mp3", word: 'むせきにん', prosody: '抑揚あり' },
      { file: "https://raw.githubusercontent.com/hninoue/survey_240094/main/word033_no.mp3", word: 'ねつさまし', prosody: '抑揚なし' },
      { file: "https://raw.githubusercontent.com/hninoue/survey_240094/main/word034_up.mp3", word: 'くりかえし', prosody: '抑揚あり' },
      { file: "https://raw.githubusercontent.com/hninoue/survey_240094/main/word035_up.mp3", word: 'たねあかし', prosody: '抑揚あり' },
      { file: "https://raw.githubusercontent.com/hninoue/survey_240094/main/word036_no.mp3", word: 'ていしせい', prosody: '抑揚なし' },
      { file: "https://raw.githubusercontent.com/hninoue/survey_240094/main/word037_up.mp3", word: 'むしさされ', prosody: '抑揚あり' },
      { file: "https://raw.githubusercontent.com/hninoue/survey_240094/main/word038_no.mp3", word: 'はまりやく', prosody: '抑揚なし' },
      { file: "https://raw.githubusercontent.com/hninoue/survey_240094/main/word039_up.mp3", word: 'ななひかり', prosody: '抑揚あり' },
      { file: "https://raw.githubusercontent.com/hninoue/survey_240094/main/word040_no.mp3", word: 'ほしあかり', prosody: '抑揚なし' },
      { file: "https://raw.githubusercontent.com/hninoue/survey_240094/main/word041_up.mp3", word: 'うんまかせ', prosody: '抑揚あり' },
      { file: "https://raw.githubusercontent.com/hninoue/survey_240094/main/word042_no.mp3", word: 'ひこうしき', prosody: '抑揚なし' },
      { file: "https://raw.githubusercontent.com/hninoue/survey_240094/main/word043_up.mp3", word: 'ものわすれ', prosody: '抑揚あり' },
      { file: "https://raw.githubusercontent.com/hninoue/survey_240094/main/word044_no.mp3", word: 'ふかくてい', prosody: '抑揚なし' },
      { file: "https://raw.githubusercontent.com/hninoue/survey_240094/main/word045_up.mp3", word: 'ひとつまみ', prosody: '抑揚あり' },
      { file: "https://raw.githubusercontent.com/hninoue/survey_240094/main/word046_no.mp3", word: 'きねんさい', prosody: '抑揚なし' },
      { file: "https://raw.githubusercontent.com/hninoue/survey_240094/main/word047_no.mp3", word: 'まえのめり', prosody: '抑揚なし' },
      { file: "https://raw.githubusercontent.com/hninoue/survey_240094/main/word048_up.mp3", word: 'こうはんい', prosody: '抑揚あり' },
      { file: "https://raw.githubusercontent.com/hninoue/survey_240094/main/word049_no.mp3", word: 'さらまわし', prosody: '抑揚なし' },
      { file: "https://raw.githubusercontent.com/hninoue/survey_240094/main/word050_up.mp3", word: 'からまわり', prosody: '抑揚あり' },
      { file: "https://raw.githubusercontent.com/hninoue/survey_240094/main/word051_no.mp3", word: 'あめおんな', prosody: '抑揚なし' },
      { file: "https://raw.githubusercontent.com/hninoue/survey_240094/main/word052_up.mp3", word: 'おすそわけ', prosody: '抑揚あり' },
      { file: "https://raw.githubusercontent.com/hninoue/survey_240094/main/word053_no.mp3", word: 'あしならし', prosody: '抑揚なし' },
      { file: "https://raw.githubusercontent.com/hninoue/survey_240094/main/word054_up.mp3", word: 'なかなおり', prosody: '抑揚あり' },
      { file: "https://raw.githubusercontent.com/hninoue/survey_240094/main/word055_up.mp3", word: 'ひなまつり', prosody: '抑揚あり' },
      { file: "https://raw.githubusercontent.com/hninoue/survey_240094/main/word056_no.mp3", word: 'しんきろう', prosody: '抑揚なし' },
      { file: "https://raw.githubusercontent.com/hninoue/survey_240094/main/word057_up.mp3", word: 'くさむしり', prosody: '抑揚あり' },
      { file: "https://raw.githubusercontent.com/hninoue/survey_240094/main/word058_no.mp3", word: 'ひとさらい', prosody: '抑揚なし' },
      { file: "https://raw.githubusercontent.com/hninoue/survey_240094/main/word059_up.mp3", word: 'ふくさよう', prosody: '抑揚あり' },
      { file: "https://raw.githubusercontent.com/hninoue/survey_240094/main/word060_no.mp3", word: 'ことこまか', prosody: '抑揚なし' },
      { file: "https://raw.githubusercontent.com/hninoue/survey_240094/main/word061_no.mp3", word: 'おにやんま', prosody: '抑揚なし' },
      { file: "https://raw.githubusercontent.com/hninoue/survey_240094/main/word062_up.mp3", word: 'はかまいり', prosody: '抑揚あり' },
      { file: "https://raw.githubusercontent.com/hninoue/survey_240094/main/word063_up.mp3", word: 'むこようし', prosody: '抑揚あり' },
      { file: "https://raw.githubusercontent.com/hninoue/survey_240094/main/word064_no.mp3", word: 'おみとおし', prosody: '抑揚なし' },
      { file: "https://raw.githubusercontent.com/hninoue/survey_240094/main/word065_up.mp3", word: 'くみあわせ', prosody: '抑揚あり' },
      { file: "https://raw.githubusercontent.com/hninoue/survey_240094/main/word066_no.mp3", word: 'まてんろう', prosody: '抑揚なし' },
      { file: "https://raw.githubusercontent.com/hninoue/survey_240094/main/word067_no.mp3", word: 'きそゆうよ', prosody: '抑揚なし' },
      { file: "https://raw.githubusercontent.com/hninoue/survey_240094/main/word068_up.mp3", word: 'かたおもい', prosody: '抑揚あり' },
      { file: "https://raw.githubusercontent.com/hninoue/survey_240094/main/word069_no.mp3", word: 'やまおとこ', prosody: '抑揚なし' },
      { file: "https://raw.githubusercontent.com/hninoue/survey_240094/main/word070_up.mp3", word: 'いしあたま', prosody: '抑揚あり' },
      { file: "https://raw.githubusercontent.com/hninoue/survey_240094/main/word071_no.mp3", word: 'しうんてん', prosody: '抑揚なし' },
      { file: "https://raw.githubusercontent.com/hninoue/survey_240094/main/word072_up.mp3", word: 'てれかくし', prosody: '抑揚あり' },
      { file: "https://raw.githubusercontent.com/hninoue/survey_240094/main/word073_no.mp3", word: 'たなおろし', prosody: '抑揚なし' },
      { file: "https://raw.githubusercontent.com/hninoue/survey_240094/main/word074_up.mp3", word: 'おきにいり', prosody: '抑揚あり' },
      { file: "https://raw.githubusercontent.com/hninoue/survey_240094/main/word075_up.mp3", word: 'そらもよう', prosody: '抑揚あり' },
      { file: "https://raw.githubusercontent.com/hninoue/survey_240094/main/word076_no.mp3", word: 'かものはし', prosody: '抑揚なし' },
      { file: "https://raw.githubusercontent.com/hninoue/survey_240094/main/word077_up.mp3", word: 'なきわらい', prosody: '抑揚あり' },
      { file: "https://raw.githubusercontent.com/hninoue/survey_240094/main/word078_no.mp3", word: 'ゆめまくら', prosody: '抑揚なし' },
      { file: "https://raw.githubusercontent.com/hninoue/survey_240094/main/word079_up.mp3", word: 'おおみそか', prosody: '抑揚あり' },
      { file: "https://raw.githubusercontent.com/hninoue/survey_240094/main/word080_no.mp3", word: 'ししんけい', prosody: '抑揚なし' },
      { file: "https://raw.githubusercontent.com/hninoue/survey_240094/main/word081_up.mp3", word: 'ゆめまくら', prosody: '抑揚あり' },
      { file: "https://raw.githubusercontent.com/hninoue/survey_240094/main/word082_no.mp3", word: 'おきにいり', prosody: '抑揚なし' },
      { file: "https://raw.githubusercontent.com/hninoue/survey_240094/main/word083_up.mp3", word: 'ほしあかり', prosody: '抑揚あり' },
      { file: "https://raw.githubusercontent.com/hninoue/survey_240094/main/word084_no.mp3", word: 'はやとちり', prosody: '抑揚なし' },
      { file: "https://raw.githubusercontent.com/hninoue/survey_240094/main/word085_up.mp3", word: 'にもうさく', prosody: '抑揚あり' },
      { file: "https://raw.githubusercontent.com/hninoue/survey_240094/main/word086_no.mp3", word: 'たまひろい', prosody: '抑揚なし' },
      { file: "https://raw.githubusercontent.com/hninoue/survey_240094/main/word087_up.mp3", word: 'くらやしき', prosody: '抑揚あり' },
      { file: "https://raw.githubusercontent.com/hninoue/survey_240094/main/word088_no.mp3", word: 'いしあたま', prosody: '抑揚なし' },
      { file: "https://raw.githubusercontent.com/hninoue/survey_240094/main/word089_up.mp3", word: 'おにやんま', prosody: '抑揚あり' },
      { file: "https://raw.githubusercontent.com/hninoue/survey_240094/main/word090_no.mp3", word: 'てれかくし', prosody: '抑揚なし' },
      { file: "https://raw.githubusercontent.com/hninoue/survey_240094/main/word091_no.mp3", word: 'かたおもい', prosody: '抑揚なし' },
      { file: "https://raw.githubusercontent.com/hninoue/survey_240094/main/word092_up.mp3", word: 'なまかわき', prosody: '抑揚あり' },
      { file: "https://raw.githubusercontent.com/hninoue/survey_240094/main/word093_no.mp3", word: 'はやおくり', prosody: '抑揚なし' },
      { file: "https://raw.githubusercontent.com/hninoue/survey_240094/main/word094_up.mp3", word: 'ていしせい', prosody: '抑揚あり' },
      { file: "https://raw.githubusercontent.com/hninoue/survey_240094/main/word095_up.mp3", word: 'やまおとこ', prosody: '抑揚あり' },
      { file: "https://raw.githubusercontent.com/hninoue/survey_240094/main/word096_no.mp3", word: 'おおみそか', prosody: '抑揚なし' },
      { file: "https://raw.githubusercontent.com/hninoue/survey_240094/main/word097_up.mp3", word: 'まてんろう', prosody: '抑揚あり' },
      { file: "https://raw.githubusercontent.com/hninoue/survey_240094/main/word098_no.mp3", word: 'みせいねん', prosody: '抑揚なし' },
      { file: "https://raw.githubusercontent.com/hninoue/survey_240094/main/word099_no.mp3", word: 'ななひかり', prosody: '抑揚なし' },
      { file: "https://raw.githubusercontent.com/hninoue/survey_240094/main/word100_up.mp3", word: 'ししんけい', prosody: '抑揚あり' },
      { file: "https://raw.githubusercontent.com/hninoue/survey_240094/main/word101_up.mp3", word: 'やけのはら', prosody: '抑揚あり' },
      { file: "https://raw.githubusercontent.com/hninoue/survey_240094/main/word102_no.mp3", word: 'すききらい', prosody: '抑揚なし' },
      { file: "https://raw.githubusercontent.com/hninoue/survey_240094/main/word103_no.mp3", word: 'おすそわけ', prosody: '抑揚なし' },
      { file: "https://raw.githubusercontent.com/hninoue/survey_240094/main/word104_up.mp3", word: 'おみとおし', prosody: '抑揚あり' },
      { file: "https://raw.githubusercontent.com/hninoue/survey_240094/main/word105_no.mp3", word: 'なかなおり', prosody: '抑揚なし' },
      { file: "https://raw.githubusercontent.com/hninoue/survey_240094/main/word106_up.mp3", word: 'まえのめり', prosody: '抑揚あり' },
      { file: "https://raw.githubusercontent.com/hninoue/survey_240094/main/word107_up.mp3", word: 'すなあらし', prosody: '抑揚あり' },
      { file: "https://raw.githubusercontent.com/hninoue/survey_240094/main/word108_no.mp3", word: 'むしさされ', prosody: '抑揚なし' },
      { file: "https://raw.githubusercontent.com/hninoue/survey_240094/main/word109_no.mp3", word: 'くみあわせ', prosody: '抑揚なし' },
      { file: "https://raw.githubusercontent.com/hninoue/survey_240094/main/word110_up.mp3", word: 'たなおろし', prosody: '抑揚あり' },
      { file: "https://raw.githubusercontent.com/hninoue/survey_240094/main/word111_no.mp3", word: 'ひとつまみ', prosody: '抑揚なし' },
      { file: "https://raw.githubusercontent.com/hninoue/survey_240094/main/word112_up.mp3", word: 'かものはし', prosody: '抑揚あり' },
      { file: "https://raw.githubusercontent.com/hninoue/survey_240094/main/word113_up.mp3", word: 'あおにさい', prosody: '抑揚あり' },
      { file: "https://raw.githubusercontent.com/hninoue/survey_240094/main/word114_no.mp3", word: 'ついしけん', prosody: '抑揚なし' },
      { file: "https://raw.githubusercontent.com/hninoue/survey_240094/main/word115_no.mp3", word: 'くさむしり', prosody: '抑揚なし' },
      { file: "https://raw.githubusercontent.com/hninoue/survey_240094/main/word116_up.mp3", word: 'しんきろう', prosody: '抑揚あり' },
      { file: "https://raw.githubusercontent.com/hninoue/survey_240094/main/word117_no.mp3", word: 'ひなまつり', prosody: '抑揚なし' },
      { file: "https://raw.githubusercontent.com/hninoue/survey_240094/main/word118_up.mp3", word: 'さんかいき', prosody: '抑揚あり' },
      { file: "https://raw.githubusercontent.com/hninoue/survey_240094/main/word119_no.mp3", word: 'こうはんい', prosody: '抑揚なし' },
      { file: "https://raw.githubusercontent.com/hninoue/survey_240094/main/word120_up.mp3", word: 'むせいらん', prosody: '抑揚あり' },
      { file: "https://raw.githubusercontent.com/hninoue/survey_240094/main/word121_no.mp3", word: 'はえたたき', prosody: '抑揚なし' },
      { file: "https://raw.githubusercontent.com/hninoue/survey_240094/main/word122_up.mp3", word: 'きんみらい', prosody: '抑揚あり' },
      { file: "https://raw.githubusercontent.com/hninoue/survey_240094/main/word123_up.mp3", word: 'きそゆうよ', prosody: '抑揚あり' },
      { file: "https://raw.githubusercontent.com/hninoue/survey_240094/main/word124_no.mp3", word: 'かねもうけ', prosody: '抑揚なし' },
      { file: "https://raw.githubusercontent.com/hninoue/survey_240094/main/word125_no.mp3", word: 'ふくさよう', prosody: '抑揚なし' },
      { file: "https://raw.githubusercontent.com/hninoue/survey_240094/main/word126_up.mp3", word: 'いろなおし', prosody: '抑揚あり' },
      { file: "https://raw.githubusercontent.com/hninoue/survey_240094/main/word127_up.mp3", word: 'ふかくてい', prosody: '抑揚あり' },
      { file: "https://raw.githubusercontent.com/hninoue/survey_240094/main/word128_no.mp3", word: 'くりかえし', prosody: '抑揚なし' },
      { file: "https://raw.githubusercontent.com/hninoue/survey_240094/main/word129_up.mp3", word: 'きねんさい', prosody: '抑揚あり' },
      { file: "https://raw.githubusercontent.com/hninoue/survey_240094/main/word130_no.mp3", word: 'からまわり', prosody: '抑揚なし' },
      { file: "https://raw.githubusercontent.com/hninoue/survey_240094/main/word131_up.mp3", word: 'ことこまか', prosody: '抑揚あり' },
      { file: "https://raw.githubusercontent.com/hninoue/survey_240094/main/word132_no.mp3", word: 'なきわらい', prosody: '抑揚なし' },
      { file: "https://raw.githubusercontent.com/hninoue/survey_240094/main/word133_no.mp3", word: 'たねあかし', prosody: '抑揚なし' },
      { file: "https://raw.githubusercontent.com/hninoue/survey_240094/main/word134_up.mp3", word: 'うちいわい', prosody: '抑揚あり' },
      { file: "https://raw.githubusercontent.com/hninoue/survey_240094/main/word135_no.mp3", word: 'むこようし', prosody: '抑揚なし' },
      { file: "https://raw.githubusercontent.com/hninoue/survey_240094/main/word136_up.mp3", word: 'ひこうしき', prosody: '抑揚あり' },
      { file: "https://raw.githubusercontent.com/hninoue/survey_240094/main/word137_no.mp3", word: 'なまけもの', prosody: '抑揚なし' },
      { file: "https://raw.githubusercontent.com/hninoue/survey_240094/main/word138_up.mp3", word: 'ねつさまし', prosody: '抑揚あり' },
      { file: "https://raw.githubusercontent.com/hninoue/survey_240094/main/word139_no.mp3", word: 'みかいけつ', prosody: '抑揚なし' },
      { file: "https://raw.githubusercontent.com/hninoue/survey_240094/main/word140_up.mp3", word: 'むいちもん', prosody: '抑揚あり' },
      { file: "https://raw.githubusercontent.com/hninoue/survey_240094/main/word141_no.mp3", word: 'うりふたつ', prosody: '抑揚なし' },
      { file: "https://raw.githubusercontent.com/hninoue/survey_240094/main/word142_up.mp3", word: 'つみつくり', prosody: '抑揚あり' },
      { file: "https://raw.githubusercontent.com/hninoue/survey_240094/main/word143_no.mp3", word: 'おひとよし', prosody: '抑揚なし' },
      { file: "https://raw.githubusercontent.com/hninoue/survey_240094/main/word144_up.mp3", word: 'しうんてん', prosody: '抑揚あり' },
      { file: "https://raw.githubusercontent.com/hninoue/survey_240094/main/word145_no.mp3", word: 'つなわたり', prosody: '抑揚なし' },
      { file: "https://raw.githubusercontent.com/hninoue/survey_240094/main/word146_up.mp3", word: 'たこうしき', prosody: '抑揚あり' },
      { file: "https://raw.githubusercontent.com/hninoue/survey_240094/main/word147_no.mp3", word: 'そらもよう', prosody: '抑揚なし' },
      { file: "https://raw.githubusercontent.com/hninoue/survey_240094/main/word148_up.mp3", word: 'てつあれい', prosody: '抑揚あり' },
      { file: "https://raw.githubusercontent.com/hninoue/survey_240094/main/word149_up.mp3", word: 'ひとさらい', prosody: '抑揚あり' },
      { file: "https://raw.githubusercontent.com/hninoue/survey_240094/main/word150_no.mp3", word: 'むせきにん', prosody: '抑揚なし' },
      { file: "https://raw.githubusercontent.com/hninoue/survey_240094/main/word151_no.mp3", word: 'ものわすれ', prosody: '抑揚なし' },
      { file: "https://raw.githubusercontent.com/hninoue/survey_240094/main/word152_up.mp3", word: 'あしならし', prosody: '抑揚あり' },
      { file: "https://raw.githubusercontent.com/hninoue/survey_240094/main/word153_no.mp3", word: 'はかまいり', prosody: '抑揚なし' },
      { file: "https://raw.githubusercontent.com/hninoue/survey_240094/main/word154_up.mp3", word: 'あめおんな', prosody: '抑揚あり' },
      { file: "https://raw.githubusercontent.com/hninoue/survey_240094/main/word155_up.mp3", word: 'さらまわし', prosody: '抑揚あり' },
      { file: "https://raw.githubusercontent.com/hninoue/survey_240094/main/word156_no.mp3", word: 'たほうめん', prosody: '抑揚なし' },
      { file: "https://raw.githubusercontent.com/hninoue/survey_240094/main/word157_up.mp3", word: 'はまりやく', prosody: '抑揚あり' },
      { file: "https://raw.githubusercontent.com/hninoue/survey_240094/main/word158_no.mp3", word: 'ひるやすみ', prosody: '抑揚なし' },
      { file: "https://raw.githubusercontent.com/hninoue/survey_240094/main/word159_up.mp3", word: 'やくはらい', prosody: '抑揚あり' },
      { file: "https://raw.githubusercontent.com/hninoue/survey_240094/main/word160_no.mp3", word: 'うんまかせ', prosody: '抑揚なし' },
    ];

    // 参加者IDの取得
    var participantId = jsPsych.data.getURLVariable('participant_id') || 1;

    // 提示順を決定
    var trialOrder;
    if (participantId % 2 === 1) {
        trialOrder = audioData; // 奇数番目の参加者: そのままの順番
    } else {
        trialOrder = audioData.slice().reverse(); // 偶数番目の参加者: 逆順
    }

    // プリロード設定
    var preload = {
      type: jsPsychPreload,
      audio: trialOrder.map(item => item.file) // 使用する音声ファイルをすべてプリロード
    };

    // 音量調整フェイズ：教示
    var volumeInstruction = {
      type: jsPsychHtmlKeyboardResponse,
      stimulus: `
        <h1>事前準備</h1>
        <p>これから調査の準備を始めます。</p>
        <ul>
            <li><b>お願い１</b><br>パソコン以外の機器の電源をOFFにして雑音が聞こえないようにしてください。</li>
            <li><b>お願い２</b><br>１人きりになれる静かな環境に移動してください。</li>
            <li><b>お願い３</b><br>ヘッドフォンまたはイヤフォンを装着してください。</li>
            <li><b>お願い４</b><br>次画面においてテスト音声が流れますので、聞こえやすい音量に調整してください。</li>
        </ul>
        <br><br><b>上記の内容について準備できましたらスペースキーを押してください。</b>
      `,
      choices: [' ']
    };

    // 音量調整フェイズ：操作
    var volumeAdjustment = {
      type: jsPsychAudioKeyboardResponse,
      stimulus: trialOrder[0].file, // 音声ファイルのURLを直接指定
      prompt: `
        <h1>音量調整</h1>
        <p>以下の音声を再生します。聞こえやすい音量に調整してください。</p>
        <p>調整が終わりましたらスペースキーを押してください。</p>
      `,
      choices: [' '],
      trial_ends_after_audio: false
    };

    // 本試行：教示
    var mainInstruction = {
      type: jsPsychHtmlKeyboardResponse,
      stimulus: `
        <h1>調査内容</h1>
        <p>これから調査を始めます。この調査では、<b>話し方の自然さ</b>を調べます。</p>
        <p>提示された音声が、<b>どの程度自然に話しているように聞こえるか</b>を判断してください。</p>
        <ul>
            <li><b>留意事項１:</b> 提示された音声について<u>自然だと思う場合</u>は<b>大きな数字</b>を、<u>不自然だと思う場合</u>は<b>小さな数字</b>を選択してください。</li>
            <li><b>留意事項２:</b> 試行数は全部で160試行ですが、80試行目で約30秒間の小休憩を取ります。</li>
            <li><b>留意事項３:</b> 同じ言葉が何回も流れますが、気にする必要はありません。</li>
        </ul>
        <p><b>上記の内容について理解できましたら、スペースキーを押してください。</b></p>
      `,
      choices: [' ']
    };

    // 本試行：練習
    var mainPractice = {
      type: jsPsychHtmlButtonResponse,
      stimulus: `
        <h1>回答練習</h1>
        <p>「5: やや自然である」と回答する場合、「5」のボタンをクリックしてください。</p>
        <p>以下の質問に対して適切な数字を選択してください。</p>
        <p><b>質問:</b> この音声はどの程度自然に話しているように聞こえますか？</p>
      `,
      choices: ["1: 不自然である", "2", "3", "4", "5", "6: 自然である"],
      data: {
        practice: true, // 練習用であることを示すデータ
        correct_choice: "5" // 正解は「5」
      },
      on_finish: function(data) {
        // 選択した回答が正しいかチェック
        if (data.response !== 4) { // 配列のインデックスでチェック (4 = "5"の位置)
          alert("練習ですので、正しい回答を選択してください。「5: やや自然である」をクリックしてください。");
        }
      }
    };
    
   // 本試行：操作
   var mainTrials = [];
   trialOrder.slice(1).forEach(function(trial, index) {
       // 音声提示と自然さの評価を同時に行う
       mainTrials.push({
           type: jsPsychHtmlButtonResponse, // 一つの画面で提示
           stimulus: `
               <div>
                   <audio id="audio-player" src="${trial.file}" autoplay></audio>
               </div>
           `,
           prompt: `
               <p><b>質問:</b> この音声はどの程度自然に話しているように聞こえますか？</p>
           `,
           choices: ["1: 不自然である", "2", "3", "4", "5", "6: 自然である"],
           data: {
               word: trial.word,
               prosody: trial.prosody,
               trial_index: index + 1
           },
           trial_ends_after_audio: true  // 音声が再生された後に試行を終了
       });

       // 80試行目終了後に休憩を挿入
       if ((index + 1) === 80) {
           mainTrials.push({
               type: jsPsychHtmlKeyboardResponse,
               stimulus: `
                   <h1>休憩</h1>
                   <p>休憩時間は30秒です。経過後、自動的に調査を再開します。</p>
                   <p>ヘッドフォンをつけたまま、リラックスしてその場でお待ちください。</p>
               `,
               choices: "NO_KEYS",
               trial_duration: 30000 // 30秒
           });
       }
    });

    // 終了時のコード提示
    var showCode = {
        type: jsPsychHtmlKeyboardResponse,
        stimulus: `
            <h1>調査終了</h1>
            <p>調査にご協力くださり誠にありがとうございました。</p>
            <ul>
                <li><b>お願い１:</b> Amazonギフト券をお送りするために、法政Gmailアドレスが必要です。</li>
                <li><b>お願い２:</b> 以下のコードを控えてください: <strong>${Math.random().toString(36).substring(2, 8).toUpperCase()}</strong></li>
            </ul>
            <p><b>コードを控えることができましたら、スペースキーを押してください。</b></p>
        `,
        choices: [' ']
    };

    // データ保存用の設定
    const save_data = {
        type: jsPsychPipe,
        action: "save",
        experiment_id: "ZWmEpETHLVnZ", // OSFでの実験ID
        filename: `${participantId}.csv`, // ファイル名に参加者IDを使用
        data_string: () => jsPsych.data.get().csv()
    };

    // 実験の実行
    jsPsych.run([
        preload,            // 音声のプリロード
        volumeInstruction,  // 音量調整フェイズ：教示
        volumeAdjustment,   // 音量調整フェイズ：操作
        mainInstruction,    // 本試行：教示
        mainPractice,       // 本試行：練習
        ...mainTrials,      // 本試行：操作
        showCode,           // 終了時のコード提示
        save_data           // データ保存
    ]);
  </script>
</html>
